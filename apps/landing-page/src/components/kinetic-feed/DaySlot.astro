---
/**
 * DaySlot - A single day column in the weekly schedule grid
 * Shows day label and contains tweet card slot
 */
import { cn } from "@repo/ui/lib/utils";

interface Props {
    day: string;
    dayShort: string;
    isToday?: boolean;
    index: number;
    class?: string;
}

const { day, dayShort, isToday = false, index, class: className } = Astro.props;
---

<div
    class={cn(
        "day-slot relative flex flex-col items-center gap-3",
        "opacity-0 translate-y-4",
        className,
    )}
    data-day-index={index}
>
    <!-- Day label badge -->
    <div
        class={cn(
            "day-label px-3 py-1.5 rounded-lg text-xs font-semibold uppercase tracking-wider",
            "border transition-all duration-300",
            isToday
                ? "bg-primary text-primary-foreground border-primary shadow-lg shadow-primary/25"
                : "bg-card text-muted-foreground border-border hover:border-primary/50",
        )}
    >
        <span class="hidden sm:inline">{day}</span>
        <span class="sm:hidden">{dayShort}</span>
    </div>

    <!-- Vertical connector line -->
    <div
        class="day-connector relative w-px h-8 bg-gradient-to-b from-border to-transparent overflow-hidden"
    >
        <div
            class="connector-pulse absolute inset-0 bg-gradient-to-b from-primary to-transparent scale-y-0 origin-top"
        >
        </div>
    </div>

    <!-- Empty slot indicator (before tweet materializes) -->
    <div
        class={cn(
            "empty-slot w-full min-h-[140px] rounded-xl border-2 border-dashed",
            "flex items-center justify-center transition-all duration-300",
            isToday
                ? "border-primary/30 bg-primary/5"
                : "border-border/50 bg-card/30",
        )}
    >
        <div class="slot-content opacity-40 text-center">
            <svg
                class="h-6 w-6 mx-auto mb-1 text-muted-foreground"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
            >
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
            <span class="text-[10px] text-muted-foreground">Empty</span>
        </div>
    </div>

    <!-- Tweet cards will be rendered here via slot -->
    <div class="tweet-slot absolute top-[4.5rem] left-0 right-0">
        <slot />
    </div>
</div>

<style>
    .day-slot {
        will-change: transform, opacity;
    }

    .day-slot.visible {
        opacity: 1;
        transform: translateY(0);
    }

    .day-slot.has-tweet .empty-slot {
        opacity: 0;
        transform: scale(0.95);
    }

    .connector-pulse.active {
        animation: pulse-down 0.6s ease-out forwards;
    }

    @keyframes pulse-down {
        0% {
            transform: scaleY(0);
        }
        100% {
            transform: scaleY(1);
        }
    }
</style>
